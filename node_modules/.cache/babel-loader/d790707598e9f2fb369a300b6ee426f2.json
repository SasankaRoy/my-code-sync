{"ast":null,"code":"import _asyncToGenerator from\"E:/onlineIDEwithreact/real-time-editor/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"E:/onlineIDEwithreact/real-time-editor/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"E:\\\\onlineIDEwithreact\\\\real-time-editor\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useRef,useEffect}from\"react\";import{Client}from\"./Client\";import{Editor}from\"./Editor\";import{initSocket}from\"../socket\";import Events from\"../Events\";import{useLocation,useNavigate,Navigate,useParams}from\"react-router-dom\";import toast from\"react-hot-toast\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var Editorpage=function Editorpage(){var reactNavigator=useNavigate();var location=useLocation();var prams=useParams();var roomId=prams.roomId;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),connect1=_useState2[0],setconnect1=_useState2[1];var socketRef=useRef(null);var codeRef=useRef(null);useEffect(function(){var init=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _location$state;var handleError;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:handleError=function _handleError(E){console.log(\"socket erron\",E);toast.error(\"Socket connection failed , try again later\");reactNavigator(\"/\");};_context.next=3;return initSocket();case 3:socketRef.current=_context.sent;socketRef.current.on(\"connect_err\",function(err){return handleError(err);});socketRef.current.on(\"connect_faild\",function(err){return handleError(err);});socketRef.current.emit(Events.Join,{roomId:roomId,username:(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.input2});//listening for joined event\nsocketRef.current.on(Events.Joined,function(_ref2){var client=_ref2.client,username=_ref2.username,socketId=_ref2.socketId;if(username!==location.state.input2){toast.success(\"\".concat(username,\" has joined the room\"));console.log(\"\".concat(username,\" has joined the room\"));}setconnect1(client);socketRef.current.emit(Events.Sync_Code,{code:codeRef.current,socketId:socketId});});// lisning for disconnect\nsocketRef.current.on(Events.Disconnected,function(_ref3){var username=_ref3.username,socketId=_ref3.socketId;toast.success(\"\".concat(username,\" disconnected\"));setconnect1(function(pre){return pre.filter(function(connect1){return connect1.socketId!==socketId;});});});case 9:case\"end\":return _context.stop();}}},_callee);}));return function init(){return _ref.apply(this,arguments);};}();init();return function(){socketRef.current.off(Events.Disconnected);socketRef.current.off(Events.Join);socketRef.current.disconnect();};},[]);if(!location.state){/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}// copyId here...\nvar copyId=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return navigator.clipboard.writeText(roomId);case 3:toast.success(\"RoomId copied successfully\");_context2.next=10;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);toast.error(\"Con't Copy RoomID\");console.error(_context2.t0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function copyId(){return _ref4.apply(this,arguments);};}();var leaveRoom=function leaveRoom(){return reactNavigator(\"/\");};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"mainWrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"leftSide\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sideInner\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsxs(\"h2\",{className:\"logo_h2\",children:[\"real-time \",/*#__PURE__*/_jsx(\"span\",{className:\"logoName\",children:\"code editor\"})]})}),/*#__PURE__*/_jsx(\"h3\",{className:\"conn_h3\",children:\"connected\"}),/*#__PURE__*/_jsx(\"div\",{className:\"connected_list\",children:connect1.map(function(client){return/*#__PURE__*/_jsx(Client,{username:client.username},client.stockeId);})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn_copy\",onClick:copyId,children:\"copy Room ID\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn_leave\",onClick:leaveRoom,children:\"Leave\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"editor\",children:/*#__PURE__*/_jsx(Editor,{socketRef:socketRef,roomId:roomId,getCode:function getCode(code){codeRef.current=code;}})})]})});};","map":{"version":3,"sources":["E:/onlineIDEwithreact/real-time-editor/src/components/Editorpage.js"],"names":["React","useState","useRef","useEffect","Client","Editor","initSocket","Events","useLocation","useNavigate","Navigate","useParams","toast","Editorpage","reactNavigator","location","prams","roomId","connect1","setconnect1","socketRef","codeRef","init","handleError","E","console","log","error","current","on","err","emit","Join","username","state","input2","Joined","client","socketId","success","Sync_Code","code","Disconnected","pre","filter","off","disconnect","copyId","navigator","clipboard","writeText","leaveRoom","map","stockeId"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport { Client } from \"./Client\";\r\nimport { Editor } from \"./Editor\";\r\nimport { initSocket } from \"../socket\";\r\nimport Events from \"../Events\";\r\nimport {\r\n  useLocation,\r\n  useNavigate,\r\n  Navigate,\r\n  useParams,\r\n} from \"react-router-dom\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nexport const Editorpage = () => {\r\n  const reactNavigator = useNavigate();\r\n  const location = useLocation();\r\n  const prams = useParams();\r\n  const roomId = prams.roomId;\r\n\r\n  const [connect1, setconnect1] = useState([]);\r\n  const socketRef = useRef(null);\r\n  const codeRef = useRef(null);\r\n  useEffect(() => {\r\n    const init = async () => {\r\n      socketRef.current = await initSocket();\r\n      socketRef.current.on(\"connect_err\", (err) => handleError(err));\r\n      socketRef.current.on(\"connect_faild\", (err) => handleError(err));\r\n      function handleError(E) {\r\n        console.log(\"socket erron\", E);\r\n        toast.error(\"Socket connection failed , try again later\");\r\n        reactNavigator(\"/\");\r\n      }\r\n      socketRef.current.emit(Events.Join, {\r\n        roomId,\r\n        username: location.state?.input2,\r\n      });\r\n\r\n      //listening for joined event\r\n      socketRef.current.on(Events.Joined, ({ client, username, socketId }) => {\r\n        if (username !== location.state.input2) {\r\n          toast.success(`${username} has joined the room`);\r\n          console.log(`${username} has joined the room`);\r\n        }\r\n        setconnect1(client);\r\n        socketRef.current.emit(Events.Sync_Code,{\r\n          code:codeRef.current,\r\n          socketId\r\n        })\r\n      });\r\n\r\n      // lisning for disconnect\r\n\r\n      socketRef.current.on(Events.Disconnected, ({ username, socketId }) => {\r\n        toast.success(`${username} disconnected`);\r\n        setconnect1((pre) => {\r\n          return pre.filter((connect1) => connect1.socketId !== socketId);\r\n        });\r\n      });\r\n    };\r\n    init();\r\n    return () => {\r\n      socketRef.current.off(Events.Disconnected);\r\n      socketRef.current.off(Events.Join);\r\n      socketRef.current.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  if (!location.state) {\r\n    <Navigate to=\"/\" />;\r\n  }\r\n\r\n  // copyId here...\r\n\r\n  const copyId = async () => {\r\n    try {\r\n      await navigator.clipboard.writeText(roomId);\r\n      toast.success(\"RoomId copied successfully\");\r\n    } catch (error) {\r\n      toast.error(\"Con't Copy RoomID\");\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const leaveRoom = () => {\r\n    return reactNavigator(\"/\");\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"mainWrap\">\r\n        <div className=\"leftSide\">\r\n          <div className=\"sideInner\">\r\n            <div className=\"logo\">\r\n              <h2 className=\"logo_h2\">\r\n                real-time <span className=\"logoName\">code editor</span>\r\n              </h2>\r\n            </div>\r\n            <h3 className=\"conn_h3\">connected</h3>\r\n            <div className=\"connected_list\">\r\n              {connect1.map((client) => (\r\n                <Client key={client.stockeId} username={client.username} />\r\n              ))}\r\n            </div>\r\n          </div>\r\n          <button className=\"btn btn_copy\" onClick={copyId}>\r\n            copy Room ID\r\n          </button>\r\n          <button className=\"btn btn_leave\" onClick={leaveRoom}>\r\n            Leave\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"editor\">\r\n          <Editor socketRef={socketRef} roomId={roomId} getCode={(code)=>{\r\n            codeRef.current = code;\r\n          }} />\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}