{"ast":null,"code":"import _asyncToGenerator from\"E:/onlineIDEwithreact/real-time-editor/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"E:\\\\onlineIDEwithreact\\\\real-time-editor\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useRef}from\"react\";import codeMirror from\"codemirror\";import\"codemirror/mode/javascript/javascript\";import\"codemirror/theme/dracula.css\";import\"codemirror/addon/edit/closetag\";import\"codemirror/addon/edit/closebrackets\";import\"codemirror/lib/codemirror.css\";import Events from\"../Events\";// const textA = document.getElementById('RTeditor');\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var Editor=function Editor(_ref){var socketRef=_ref.socketRef,roomId=_ref.roomId,getCode=_ref.getCode;var editorRef=useRef(null);useEffect(function(){function init(){return _init.apply(this,arguments);}function _init(){_init=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:editorRef.current=codeMirror.fromTextArea(document.getElementById(\"RTeditor\"),{mode:{name:\"javascript\",json:true},theme:\"dracula\",autoCloseTags:true,autoCloseBrackets:true,lineNumbers:true});editorRef.current.on(\"change\",function(instance,value){var origin=value.origin;var code=instance.getValue();getCode(code);if(origin!==\"setValue\"){// console.log(\" first working\");\nsocketRef.current.emit(Events.Code_Change,{roomId:roomId,code:code});}// console.log(code);\n});case 2:case\"end\":return _context.stop();}}},_callee);}));return _init.apply(this,arguments);}init();},[]);useEffect(function(){if(socketRef.current){console.log(\"2nd useEffect\");socketRef.current.on(Events.Code_Change,function(_ref2){var code=_ref2.code;console.log(code);if(code!==null){editorRef.current.setValue(code);}});}return function(){socketRef.current.off(Events.Code_Change);};},[socketRef.current]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"textarea\",{id:\"RTeditor\"})});};","map":{"version":3,"sources":["E:/onlineIDEwithreact/real-time-editor/src/components/Editor.js"],"names":["React","useEffect","useRef","codeMirror","Events","Editor","socketRef","roomId","getCode","editorRef","init","current","fromTextArea","document","getElementById","mode","name","json","theme","autoCloseTags","autoCloseBrackets","lineNumbers","on","instance","value","origin","code","getValue","emit","Code_Change","console","log","setValue","off"],"mappings":"kQAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,MAA3B,KAAyC,OAAzC,CACA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,CACA,MAAO,uCAAP,CACA,MAAO,8BAAP,CACA,MAAO,gCAAP,CACA,MAAO,qCAAP,CACA,MAAO,+BAAP,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CACA;gGAEA,MAAO,IAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,MAAoC,IAAjCC,CAAAA,SAAiC,MAAjCA,SAAiC,CAAtBC,MAAsB,MAAtBA,MAAsB,CAAdC,OAAc,MAAdA,OAAc,CACxD,GAAMC,CAAAA,SAAS,CAAGP,MAAM,CAAC,IAAD,CAAxB,CACAD,SAAS,CAAC,UAAM,SACCS,CAAAA,IADD,sHACd,mIACED,SAAS,CAACE,OAAV,CAAoBR,UAAU,CAACS,YAAX,CAClBC,QAAQ,CAACC,cAAT,CAAwB,UAAxB,CADkB,CAElB,CACEC,IAAI,CAAE,CAAEC,IAAI,CAAE,YAAR,CAAsBC,IAAI,CAAE,IAA5B,CADR,CAEEC,KAAK,CAAE,SAFT,CAGEC,aAAa,CAAE,IAHjB,CAIEC,iBAAiB,CAAE,IAJrB,CAKEC,WAAW,CAAE,IALf,CAFkB,CAApB,CAUAZ,SAAS,CAACE,OAAV,CAAkBW,EAAlB,CAAqB,QAArB,CAA+B,SAACC,QAAD,CAAWC,KAAX,CAAqB,CAClD,GAAQC,CAAAA,MAAR,CAAmBD,KAAnB,CAAQC,MAAR,CACA,GAAMC,CAAAA,IAAI,CAAGH,QAAQ,CAACI,QAAT,EAAb,CACAnB,OAAO,CAACkB,IAAD,CAAP,CACA,GAAID,MAAM,GAAK,UAAf,CAA2B,CACzB;AACAnB,SAAS,CAACK,OAAV,CAAkBiB,IAAlB,CAAuBxB,MAAM,CAACyB,WAA9B,CAA2C,CACzCtB,MAAM,CAANA,MADyC,CAEzCmB,IAAI,CAAJA,IAFyC,CAA3C,EAID,CAED;AACD,CAbD,EAXF,sDADc,uCA2BdhB,IAAI,GACL,CA5BQ,CA4BN,EA5BM,CAAT,CA8BAT,SAAS,CAAC,UAAM,CACd,GAAIK,SAAS,CAACK,OAAd,CAAuB,CACrBmB,OAAO,CAACC,GAAR,CAAY,eAAZ,EACAzB,SAAS,CAACK,OAAV,CAAkBW,EAAlB,CAAqBlB,MAAM,CAACyB,WAA5B,CAAyC,eAAc,IAAXH,CAAAA,IAAW,OAAXA,IAAW,CACrDI,OAAO,CAACC,GAAR,CAAYL,IAAZ,EACA,GAAIA,IAAI,GAAK,IAAb,CAAmB,CACjBjB,SAAS,CAACE,OAAV,CAAkBqB,QAAlB,CAA2BN,IAA3B,EACD,CACF,CALD,EAMD,CAED,MAAO,WAAM,CACXpB,SAAS,CAACK,OAAV,CAAkBsB,GAAlB,CAAsB7B,MAAM,CAACyB,WAA7B,EACD,CAFD,CAGD,CAdQ,CAcN,CAACvB,SAAS,CAACK,OAAX,CAdM,CAAT,CAgBA,mBACE,sCACE,iBAAU,EAAE,CAAC,UAAb,EADF,EADF,CAKD,CArDM","sourcesContent":["import React, { useEffect, useRef } from \"react\";\r\nimport codeMirror from \"codemirror\";\r\nimport \"codemirror/mode/javascript/javascript\";\r\nimport \"codemirror/theme/dracula.css\";\r\nimport \"codemirror/addon/edit/closetag\";\r\nimport \"codemirror/addon/edit/closebrackets\";\r\nimport \"codemirror/lib/codemirror.css\";\r\nimport Events from \"../Events\";\r\n// const textA = document.getElementById('RTeditor');\r\n\r\nexport const Editor = ({ socketRef, roomId, getCode }) => {\r\n  const editorRef = useRef(null);\r\n  useEffect(() => {\r\n    async function init() {\r\n      editorRef.current = codeMirror.fromTextArea(\r\n        document.getElementById(\"RTeditor\"),\r\n        {\r\n          mode: { name: \"javascript\", json: true },\r\n          theme: \"dracula\",\r\n          autoCloseTags: true,\r\n          autoCloseBrackets: true,\r\n          lineNumbers: true,\r\n        }\r\n      );\r\n      editorRef.current.on(\"change\", (instance, value) => {\r\n        const { origin } = value;\r\n        const code = instance.getValue();\r\n        getCode(code);\r\n        if (origin !== \"setValue\") {\r\n          // console.log(\" first working\");\r\n          socketRef.current.emit(Events.Code_Change, {\r\n            roomId,\r\n            code,\r\n          });\r\n        }\r\n\r\n        // console.log(code);\r\n      });\r\n    }\r\n    init();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (socketRef.current) {\r\n      console.log(\"2nd useEffect\");\r\n      socketRef.current.on(Events.Code_Change, ({ code }) => {\r\n        console.log(code);\r\n        if (code !== null) {\r\n          editorRef.current.setValue(code);\r\n        }\r\n      });\r\n    }\r\n\r\n    return () => {\r\n      socketRef.current.off(Events.Code_Change);\r\n    };\r\n  }, [socketRef.current]);\r\n\r\n  return (\r\n    <>\r\n      <textarea id=\"RTeditor\"></textarea>\r\n    </>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}